(()=>{class e{#a={};emit(e,...t){if("string"!=typeof e)throw TypeError('El nombre de emit debe ser un "string"');let s=this.#a[e];s?.length&&(this.#a[e]=s.filter(e=>(e.callback(...t),e.persistence||!e.once)))}on(e,t,s){if("string"!=typeof e)throw TypeError('El nombre del evento debe ser un "string"');if("function"!=typeof t)throw TypeError('El callback del evento debe ser una "funcion"');this.#a[e]||(this.#a[e]=[]),this.#a[e].push({callback:t,once:s?.once,persistence:s?.persistence})}off(e,t){if("string"!=typeof e)throw TypeError('El nombre del evento debe ser un "string"');if("function"!=typeof t)throw TypeError('El eventFun del evento debe ser una "funcion"');let s=this.#a[e];s?.length&&(s=s.filter(e=>e!=t))}empty(e){if("string"!=typeof e)throw TypeError('El nombre de remove debe ser un "string"');this.#a[e]&&(this.#a[e]=this.#a[e].filter(e=>e.persistence))}}class t extends Map{event=new e;#b=new Map;#c=[];#d=20;#e=0;constructor(e,t=!1){super(),this.menuBox=document.createElement("div"),this.menuBox.className="selector-menu scroll-y",this.menuBox.innerHTML='<span class="menu-warn"></span>',this.showIndex=t,e.forEach(({id:e,name:t,src:s})=>this.set(String(e),{name:t,src:s,selected:0})),this.menuBox.addEventListener("scroll",()=>{let{scrollTop:e,clientHeight:t,scrollHeight:s}=this.menuBox;e+t<s||this.#f()}),this.menuBox.addEventListener("click",e=>{let t=e.target.closest(".menu-index");if(!t)return;let s=t.dataset.id;t.remove(),this._selected(s)})}set(e,t){return e=String(e),super.set(e,t)}get(e){return e=String(e),super.get(e)}has(e){return e=String(e),super.has(e)}delete(e){return e=String(e),super.delete(e)}reset(){this.#b.forEach(e=>e.closeAnchor.click())}_selected(e){e=String(e);let t=super.get(e);if(!t)return;let s={};s.id=e,s.indexData=t;let i=s.selectedBox=this.#g(t.name),n=s.closeAnchor=i.querySelector("a");return this.#b.set(e,s),this.event.emit("click",s),t.selected=1,this.draw(),n.addEventListener("click",()=>{this.event.emit("close",s),t.selected=0,i.remove(),this.draw(),this.#b.delete(e)},{once:!0}),s}#g(s){let i=document.createElement("div");return i.innerHTML=`<span>${s}</span><a><i class="bx bx-x"></i></a>`,i}_deselect(e){e=String(e);let t=this.#b.get(e);t&&t.closeAnchor.click()}search(e=""){"string"==typeof e&&(this.#c=[],this.event.emit("search",e),""==e?(this.forEach((e,t)=>{1!=e.selected&&(this.#c.push(t),e.selected=0)}),this.#h()):(this.forEach((t,s)=>{if(1!=t.selected){if(!t.name.toLowerCase().includes(e.toLowerCase()))return t.selected=-1;this.#c.push(s),t.selected=0}}),this.#i()),this.draw())}#h(){this.#c.length||(this.menuBox.innerHTML='<span class="menu-warn">Sin datos.</span>')}#i(){this.#c.length||(this.menuBox.innerHTML='<span class="menu-warn">Sin coincidencia.</span>')}draw(e="asc"){this.menuBox.innerHTML="",this.#c.length&&("asc"==e&&this.#c.sort((e,t)=>(e=super.get(e)?.name)<(t=super.get(t)?.name)?-1:e>t?1:0),"des"==e&&this.#c.sort((e,t)=>(e=super.get(e)?.name)<(t=super.get(t)?.name)?1:e>t?-1:0)),this.#e=0,this.#f()}#f(){let n=this.#d*this.#e,l=n+this.#d;if(this.#c.length<n)return;let c=this.#c.slice(n,l).filter(e=>super.has(e));this.menuBox.append(...c.map(e=>{let t=super.get(e);return this.#j(e,t.name,t.src)})),this.#e++}#j(o,r,h){let a=document.createElement("div");return a.dataset.id=o,a.className="menu-index",a.innerHTML=this.showIndex?"img"==this.showIndex?`<img src="${h}"><span>${r}</span>`:`<small>${o}</small><span>${r}</span>`:`<span>${r}</span>`,a}}class d extends e{selected=[];constructor(e,s,i=!1){if(!(e instanceof HTMLInputElement))throw TypeError("El elemento no es un input.");if(!(s instanceof t))throw TypeError("Es necesario el parametro Selector.");if(super(),this.inputElement=e,this.selectorClass=s,this.autoHide=i,this.isDisabled=e.disabled,e.insertAdjacentHTML("beforebegin",'<div class="selected-colletion"></div>'),this.colletionBox=e.previousElementSibling,!this.isDisabled){s.event.on("click",t=>{if(s.menuBox.parentNode!=e.parentNode)return;let n=this.selected[0];n&&(n.closeAnchor.click(),this.emit("change",n,t)),this.colletionBox.append(t.selectedBox),this.emit("selected",t),this.selected[0]=t,i&&(e.style.display="none")},{persistence:!0}),s.event.on("close",t=>{t.selectedBox.closest(".selected-colletion")==this.colletionBox&&(this.emit("deselected",t),this.selected.slice(0,1),i&&(e.style.display=""))},{persistence:!0});let n;this.inputElement.addEventListener("input",t=>{clearTimeout(n),n=setTimeout(()=>{this.emit("input",e.value),s.search(e.value)},300)}),this.inputElement.addEventListener("focusin",t=>{this.emit("focusin",t),this.inputElement.parentNode.append(s.menuBox),s.search(e.value)}),this.inputElement.addEventListener("focusout",e=>{this.emit("focusout",e),setTimeout(()=>{s.menuBox.remove()},200)})}}select(e){if(e=String(e),!this.selectorClass.has(e))return;if(1==this.selectorClass.get(e).selected)return;this.autoHide&&(this.inputElement.style.display="none");let t=this.selected[0];t&&(this.emit("diselected",t),t.closeAnchor.click(),this.emit("change",t));let s=this.selectorClass._selected(e);this.colletionBox.append(s.selectedBox),this.emit("selected",s),this.selected[0]=s}deselect(e){e=String(e),this.selectorClass.has(e)&&this.selected[0].id==e&&(this.autoHide&&(this.inputElement.style.display=""),this.selected[0].closeAnchor.click())}empty(){this.selected.length&&this.selected[0].closeAnchor.click()}}class u extends e{selected=[];constructor(e,s){if("INPUT"!=e.tagName)throw TypeError("El elemento no es un input.");if(!(s instanceof t))throw TypeError("Es necesario el parametro Selector.");if(super(),this.inputElement=e,this.selectorClass=s,this.isDisabled=this.inputElement.hasAttribute("disabled"),e.insertAdjacentHTML("beforebegin",'<div class="selected-colletion"></div>'),this.colletionBox=e.previousElementSibling,!this.isDisabled){s.event.on("click",t=>{s.menuBox.parentNode==e.parentNode&&(this.colletionBox.append(t.selectedBox),this.emit("selected",t),this.selected.push(t))},{persistence:!0}),s.event.on("close",e=>{if(e.selectedBox.closest(".selected-colletion")!=this.colletionBox)return;let t=this.selected.findIndex(t=>t==e);this.emit("deselected",e),this.selected.splice(t,1)},{persistence:!0});let i;this.inputElement.addEventListener("input",t=>{clearTimeout(i),i=setTimeout(()=>{this.emit("input",e.value),s.search(e.value)},300)}),this.inputElement.addEventListener("focusin",t=>{this.emit("focusin",t),this.inputElement.parentNode.append(s.menuBox),s.search(e.value)}),this.inputElement.addEventListener("focusout",e=>{this.emit("focusout",e),setTimeout(()=>{s.menuBox.remove()},200)})}}select(e){if(e=String(e),!this.selectorClass.has(e))return;if(1==this.selectorClass.get(e).selected)return;let t=this.selectorClass._selected(e);this.colletionBox.append(t.selectedBox),this.emit("selected",t),this.selected.push(t)}deselect(e){if(e=String(e),!this.selectorClass.has(e))return;let t=this.selected.findIndex(t=>t.id==e);if(-1!=t)this.selected[t].closeAnchor.click(),this.selected.splice(t,1)}empty(){this.selected.length&&this.selected.forEach(e=>e.closeAnchor.click())}}window.SelectorMap=t,window.SelectorUnic=d,window.SelectorMulti=u})();