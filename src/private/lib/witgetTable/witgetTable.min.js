(()=>{class t{#a={};emit(t,...e){if("string"!=typeof t)throw TypeError('El nombre de emit debe ser un "string"');let r=this.#a[t];r?.length&&(this.#a[t]=r.filter(t=>(t.callback(...e),t.persistence||!t.once)))}on(t,e,r){if("string"!=typeof t)throw TypeError('El nombre del evento debe ser un "string"');if("function"!=typeof e)throw TypeError('El callback del evento debe ser una "funcion"');this.#a[t]||(this.#a[t]=[]),this.#a[t].push({callback:e,once:r?.once,persistence:r?.persistence})}off(t,e){if("string"!=typeof t)throw TypeError('El nombre del evento debe ser un "string"');if("function"!=typeof e)throw TypeError('El eventFun del evento debe ser una "funcion"');let r=this.#a[t];r?.length&&(r=r.filter(t=>t!=e))}empty(t){if("string"!=typeof t)throw TypeError('El nombre de remove debe ser un "string"');this.#a[t]&&(this.#a[t]=this.#a[t].filter(t=>t.persistence))}}function e(t,e){e?.nodeType==Node.ELEMENT_NODE?t.append(e):t.innerHTML=e}class r extends t{dataTable=[];getDragger(t){let e=document.createElement("td");return e.innerHTML='<i class="bx bx-x"></i>',e.classList.add("dragger"),e.addEventListener("click",()=>{this.dataTable=this.dataTable.filter(e=>e!==t),this.tbody.removeChild(t.tr),this.emit("drop",t)}),e}constructor(t,e={drag:!0,drop:!0,columns:[]}){if("TABLE"!=t.nodeName)throw TypeError("El parametro table no es un elemento HTMLTableElement.");super(),this.table=t,this.config=e,t.classList.add("witgetTable");let r=t.querySelector("thead");this.thead=r||document.createElement("thead");let a=t.querySelector("tbody");this.tbody=a||document.createElement("tbody");let n=t.querySelector("tfoot");this.tfoot=n||document.createElement("tfoot"),t.append(this.thead,this.tbody,this.tfoot);let s=e?.columns,i=this.thead.querySelectorAll("th");if(this.columns=[...i].map((t,e)=>({tittle:s?.[e]?.tittle||t.textContent,width:s?.[e]?.width&&(t.style.width=s[e].width)||t.style.width||(t.style.width="auto"),textAlign:s?.[e]?.textAlign&&(t.style.textAlign=s[e].textAlign)||t.style.textAlign||(t.style.textAlign="center")})),!e.drop)return;let d=document.createElement("td");d.textContent="Cerrar",r.querySelector("tr").prepend(d)}newRow(t){let r=document.createElement("tr"),a={data:{},td:{},set:{},tr:r};if(this.config.drop){let n=this.getDragger(a);a.dragger=n,r.append(n)}return t?.constructor?.name=="Object"?(this.columns.forEach(({tittle:n,width:s,textAlign:i})=>{let d=document.createElement("td");d.style.width=s,d.style.textAlign=i;let o=(r=t[n]||"-")=>{e(d,r),a.data[n]=r};o(),a.set[n]=o,a.td[n]=d,r.append(d)}),a.data={...t}):t?.constructor?.name=="Array"?this.columns.forEach(({tittle:n,width:s,textAlign:i},d)=>{let o=document.createElement("td");o.style.width=s,o.style.textAlign=i;let l=(r=t[d]||"-")=>{e(o,r),a.data[n]=r};l(),a.set[n]=l,a.td[n]=o,r.append(o)}):alert(`Hay un error de tipo en la informaci\xf3n de la columna`),this.dataTable.push(a),this.tbody.append(r),this.config.drag&&this.#b(r,a),this.emit("add",a),a}#b(a=null,n){(a?[a]:this.tbody.querySelectorAll("tr:not(:first-of-type)")).forEach(t=>{t.draggable=!0,t.ondragstart=e=>{this.emit("drag",n),this.draggedRow=t,e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",t.innerHTML)},t.ondragover=t=>t.preventDefault(),t.ondrop=e=>{e.preventDefault(),this.draggedRow!==t&&(this.draggedRow.innerHTML=t.innerHTML,t.innerHTML=e.dataTransfer.getData("text/html"),this.#b(t),this.#b(this.draggedRow))},t.ondragenter=()=>t.classList.add("hover"),t.ondragleave=()=>t.classList.remove("hover"),t.ondragend=()=>{for(let t of this.tbody.querySelectorAll("tr:not(:first-of-type)"))t.classList.remove("hover")}})}}window.WitgetTable=r})();